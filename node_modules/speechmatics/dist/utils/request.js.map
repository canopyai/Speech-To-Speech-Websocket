{
  "version": 3,
  "sources": ["../../src/utils/request.ts"],
  "sourcesContent": ["export type HttpMethod = 'GET' | 'PUT' | 'POST' | 'DELETE';\n\nexport type QueryParams<K extends string = string> = Partial<\n  Record<K, string | number | boolean>\n>;\n\nexport async function request<T, K extends string = string>(\n  apiKey: string,\n  url: string,\n  path: string,\n  method: HttpMethod = 'POST',\n  payload?: BodyInit | null | undefined,\n  params?: QueryParams<K>,\n  contentType?: string,\n): Promise<T> {\n  const requestOptions: RequestInit = {\n    method,\n    headers: {\n      ...(contentType ? { 'Content-Type': contentType } : {}),\n      Authorization: `Bearer ${apiKey}`,\n    },\n    body: payload,\n  };\n\n  // Add sdk information as url query parameter\n  const parsedUrl = new URL(path, url);\n  let fullUrl = addSDKInfoToRequestUrl(parsedUrl.href);\n  if (params) {\n    fullUrl = addQueryParamsToUrl(fullUrl, params);\n  }\n\n  const response = await fetch(fullUrl, requestOptions);\n\n  if (!response.ok) {\n    throw new Error(\n      `SMjs error: ${response.statusText} ${\n        response.status\n      } ${await response.text()}`,\n    );\n  }\n\n  const isPlain = contentType === 'text/plain';\n\n  let result: T;\n  try {\n    if (isPlain) {\n      result = (await response.text()) as T;\n    } else {\n      result = (await response.json()) as T;\n    }\n  } catch (error) {\n    throw new Error(`SMjs error, can't parse json: ${error}`);\n  }\n\n  return result;\n}\n\nexport const SM_SDK_PARAM_NAME = 'sm-sdk';\nexport const SM_APP_PARAM_NAME = 'sm-app';\n\nexport function getSmSDKVersion(): string {\n  return `js-${SDK_VERSION}`;\n}\n\nexport function addQueryParamsToUrl<K extends string>(\n  url: string,\n  queryParams: QueryParams<K>,\n): string {\n  const parsedUrl = new URL(url);\n  const params = new URLSearchParams(parsedUrl.search);\n  Object.keys(queryParams).forEach((key) => {\n    const value = queryParams[key as K];\n    if (value !== undefined) params.append(key, `${value}`);\n  });\n  parsedUrl.search = params.toString();\n  return parsedUrl.href;\n}\n\nexport function addSDKInfoToRequestUrl(url: string): string {\n  return addQueryParamsToUrl(url, { [SM_SDK_PARAM_NAME]: getSmSDKVersion() });\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,eAAsB,QACpB,QACA,KACA,MACA,SAAqB,QACrB,SACA,QACA,aACY;AACZ,QAAM,iBAA8B;AAAA,IAClC;AAAA,IACA,SAAS;AAAA,MACP,GAAI,cAAc,EAAE,gBAAgB,YAAY,IAAI,CAAC;AAAA,MACrD,eAAe,UAAU,MAAM;AAAA,IACjC;AAAA,IACA,MAAM;AAAA,EACR;AAGA,QAAM,YAAY,IAAI,IAAI,MAAM,GAAG;AACnC,MAAI,UAAU,uBAAuB,UAAU,IAAI;AACnD,MAAI,QAAQ;AACV,cAAU,oBAAoB,SAAS,MAAM;AAAA,EAC/C;AAEA,QAAM,WAAW,MAAM,MAAM,SAAS,cAAc;AAEpD,MAAI,CAAC,SAAS,IAAI;AAChB,UAAM,IAAI;AAAA,MACR,eAAe,SAAS,UAAU,IAChC,SAAS,MACX,IAAI,MAAM,SAAS,KAAK,CAAC;AAAA,IAC3B;AAAA,EACF;AAEA,QAAM,UAAU,gBAAgB;AAEhC,MAAI;AACJ,MAAI;AACF,QAAI,SAAS;AACX,eAAU,MAAM,SAAS,KAAK;AAAA,IAChC,OAAO;AACL,eAAU,MAAM,SAAS,KAAK;AAAA,IAChC;AAAA,EACF,SAAS,OAAO;AACd,UAAM,IAAI,MAAM,iCAAiC,KAAK,EAAE;AAAA,EAC1D;AAEA,SAAO;AACT;AAEO,MAAM,oBAAoB;AAC1B,MAAM,oBAAoB;AAE1B,SAAS,kBAA0B;AACxC,SAAO,MAAM,OAAW;AAC1B;AAEO,SAAS,oBACd,KACA,aACQ;AACR,QAAM,YAAY,IAAI,IAAI,GAAG;AAC7B,QAAM,SAAS,IAAI,gBAAgB,UAAU,MAAM;AACnD,SAAO,KAAK,WAAW,EAAE,QAAQ,CAAC,QAAQ;AACxC,UAAM,QAAQ,YAAY,GAAQ;AAClC,QAAI,UAAU;AAAW,aAAO,OAAO,KAAK,GAAG,KAAK,EAAE;AAAA,EACxD,CAAC;AACD,YAAU,SAAS,OAAO,SAAS;AACnC,SAAO,UAAU;AACnB;AAEO,SAAS,uBAAuB,KAAqB;AAC1D,SAAO,oBAAoB,KAAK,EAAE,CAAC,iBAAiB,GAAG,gBAAgB,EAAE,CAAC;AAC5E;",
  "names": []
}
